## SYSTEM FILE: Integration_Map_Template.md

### PURPOSE: Шаблон детальной карты интеграций между всеми системами проекта (CMS, CRM, ESP, Analytics, API). Описывает точки передачи данных, идентификаторы пользователей и направления потоков данных для обеспечения бесшовной синхронизации данных.

### OWNER: Chief Technology Officer (CTO)

### STRUCTURE: Определяет все интеграции между системами, точки передачи данных, идентификаторы, методы интеграции и направления потоков данных.

---

### INSTRUCTIONS FOR USE:

- CTO заполняет все разделы на основе анализа входных данных: **Project_Plan.md**, **Marketing_Strategy.md**, **Creative_Package.md**
- **[КРИТИЧЕСКИ ВАЖНО]** Все интеграции должны быть основаны на реальных требованиях из входных документов. НЕ добавлять интеграции, которых нет в требованиях проекта.
- Все поля, помеченные как **[ОБЯЗАТЕЛЬНО]**, должны быть заполнены
- Если интеграция не требуется, указывать "Не требуется" с обоснованием
- Каждая интеграция должна содержать детальное описание: источник данных, получатель, метод, идентификаторы, цель передачи, технические детали

---

## ЧЕКЛИСТ ОБЯЗАТЕЛЬНЫХ ПОЛЕЙ

- [ ] Раздел 1: Общая информация о проекте и системах
- [ ] Раздел 2: Интеграции сайта (CMS) с внешними системами
- [ ] Раздел 3: Интеграции CRM с внешними системами
- [ ] Раздел 4: Интеграции ESP (Email-платформы) с внешними системами
- [ ] Раздел 5: Интеграции аналитики (GA4, Meta Pixel, Яндекс Метрика) с внешними системами
- [ ] Раздел 6: Идентификаторы пользователей и синхронизация данных
- [ ] Раздел 7: Схема потоков данных (визуальное описание)

---

#### 1. Общая информация о проекте и системах

**[ОБЯЗАТЕЛЬНО]** Описать контекст проекта и все используемые системы.

**Инструкция:** Указать основные системы, которые будут интегрированы, и общую цель интеграций.

- **Название проекта:** [указать]
- **Клиент:** [указать]
- **Дата создания:** [указать]
- **Ответственный:** Chief Technology Officer (CTO)
- **Источник требований:** Project_Plan.md, Marketing_Strategy.md, Creative_Package.md

**Основные системы проекта:**

- **CMS / Framework:** [Например: Single Page Startup] — [URL / домен]
- **CRM:** [Например: HubSpot / Bitrix24 / AmoCRM] — [URL / доступ]
- **ESP (Email-платформа):** [Например: SendPulse / UniSender / Mailchimp] — [URL / доступ]
- **Analytics:** [Например: GA4, Meta Pixel, Яндекс Метрика, TikTok Pixel] — [ID контейнеров / пикселей]
- **Другие системы:** [Например: API, внешние сервисы]

**Цель интеграций:**

- Обеспечить бесшовную передачу данных между всеми системами
- Синхронизировать лиды, события и конверсии для сквозной аналитики (ROMI, CAC, LTV)
- Автоматизировать коммуникационные процессы (Email, CRM-воронки)
- Обеспечить корректную атрибуцию и трекинг всех маркетинговых активностей

---

#### 2. Интеграции сайта (CMS) с внешними системами

**[ОБЯЗАТЕЛЬНО]** Описать все интеграции, которые выполняет сайт (CMS) для передачи данных во внешние системы.

**Инструкция:** Для каждой интеграции указать источник данных на сайте, получателя, метод интеграции, идентификаторы, цель и технические детали.

| №   | Источник данных на сайте                                | Получатель                                      | Метод интеграции                     | Идентификаторы                             | Поля данных                                                                                         | Цель передачи                                                                        | Технические детали                                                                                                                     | Статус                          |
| --- | ------------------------------------------------------- | ----------------------------------------------- | ------------------------------------ | ------------------------------------------ | --------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------- |
| 1   | **Форма заявки / контакта**                             | **CRM**                                         | [Например: Webhook / REST API]       | [Например: lead_id, client_id, utm_source] | [Например: имя, телефон, email, сообщение, utm_source, utm_medium, utm_campaign]                    | [Например: Создание лида в CRM для обработки менеджерами и автоматизации воронок]    | [Например: URL webhook: https://crm.example.com/webhook/lead, метод: POST, формат: JSON, заголовки: Authorization Bearer {token}]      | [Настроено / Требует настройки] |
| 2   | **Форма подписки на email**                             | **ESP (Email-платформа)**                       | [Например: API / Webhook]            | [Например: subscriber_id, email]           | [Например: email, имя, источник подписки (utm_source), сегмент]                                     | [Например: Добавление подписчика в ESP для автоматических email-цепочек]             | [Например: API endpoint: https://api.esp.example.com/subscribers, метод: POST, формат: JSON]                                           | [Настроено / Требует настройки] |
| 3   | **События пользователей (клики, просмотры, конверсии)** | **Analytics (GA4, Meta Pixel, Яндекс Метрика)** | [Например: dataLayer / GTM / Pixel]  | [Например: client_id, user_id, event_id]   | [Например: event_name, event_params (value, currency, items), utm_source, utm_medium, utm_campaign] | [Например: Отслеживание событий для аналитики ROMI, CAC, LTV и оптимизации кампаний] | [Например: GA4 Measurement ID: G-XXXXXXXXXX, Meta Pixel ID: 123456789, dataLayer структура, события: view_item, add_to_cart, purchase] | [Настроено / Требует настройки] |
| 4   | **События конверсий (покупки, заявки)**                 | **CRM**                                         | [Например: Conversion API / Webhook] | [Например: lead_id, deal_id, revenue]      | [Например: тип конверсии, стоимость, статус сделки, источник (utm_source)]                          | [Например: Синхронизация конверсий для расчета ROMI и автоматизации воронок]         | [Например: Conversion API endpoint, метод: POST, формат: JSON]                                                                         | [Настроено / Требует настройки] |

**Важно для ИИ-генерации:**

- Все интеграции должны быть детально описаны с техническими параметрами (URL, метод, формат, заголовки)
- Идентификаторы должны быть указаны для обеспечения синхронизации данных между системами
- Цель передачи должна быть связана с бизнес-метриками (ROMI, CAC, LTV) из Marketing_Strategy.md

---

#### 3. Интеграции CRM с внешними системами

**[ОБЯЗАТЕЛЬНО]** Описать все интеграции, которые выполняет CRM для передачи данных во внешние системы.

**Инструкция:** Для каждой интеграции указать источник данных в CRM, получателя, метод интеграции, идентификаторы, цель и технические детали.

| №   | Источник данных в CRM           | Получатель                      | Метод интеграции                                     | Идентификаторы                                  | Поля данных                                                                    | Цель передачи                                                                                                | Технические детали                                                                                                            | Статус                          |
| --- | ------------------------------- | ------------------------------- | ---------------------------------------------------- | ----------------------------------------------- | ------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------- | ------------------------------- |
| 1   | **Создание / обновление лида**  | **ESP (Email-платформа)**       | [Например: API / Segment Sync]                       | [Например: lead_id, email, segment_id]          | [Например: email, имя, сегмент, статус лида, источник]                         | [Например: Автоматическая синхронизация лидов в ESP для email-цепочек (Welcome Flow, Nurturing Flow)]        | [Например: API endpoint для синхронизации сегментов, метод: POST, формат: JSON, триггер: при создании/изменении статуса лида] | [Настроено / Требует настройки] |
| 2   | **Конверсии (сделки, покупки)** | **Analytics (GA4, Meta Pixel)** | [Например: Conversion API / Offline Conversions API] | [Например: client_id, deal_id, revenue, crm_id] | [Например: event_name (purchase), value, currency, client_id, utm_source]      | [Например: Передача конверсий в аналитику для сквозной аналитики ROMI и CAC (особенно для офлайн-конверсий)] | [Например: GA4 Measurement Protocol, Meta Conversions API, метод: POST, формат: JSON, привязка по client_id]                  | [Настроено / Требует настройки] |
| 3   | **Статусы лидов и сделок**      | **Analytics (GA4)**             | [Например: Custom Events / User Properties]          | [Например: user_id, lead_id, deal_id]           | [Например: статус лида (новый, в работе, закрыт), статус сделки, этап воронки] | [Например: Отслеживание прогресса лидов по воронке для анализа эффективности каналов и оптимизации]          | [Например: Custom event "lead_status_changed", user property "lead_stage", синхронизация через API]                           | [Настроено / Требует настройки] |

**Важно для ИИ-генерации:**

- Все интеграции должны быть связаны с бизнес-процессами из Marketing_Strategy.md (воронки продаж, автоматизация)
- Идентификаторы должны обеспечивать синхронизацию данных между CRM и другими системами
- Цель передачи должна поддерживать расчет ROMI, CAC, LTV

---

#### 4. Интеграции ESP (Email-платформы) с внешними системами

**[ОБЯЗАТЕЛЬНО]** Описать все интеграции, которые выполняет ESP для передачи данных во внешние системы.

**Инструкция:** Для каждой интеграции указать источник данных в ESP, получателя, метод интеграции, идентификаторы, цель и технические детали.

| №   | Источник данных в ESP                   | Получатель          | Метод интеграции                            | Идентификаторы                                     | Поля данных                                                                                          | Цель передачи                                                                              | Технические детали                                                                                         | Статус                          |
| --- | --------------------------------------- | ------------------- | ------------------------------------------- | -------------------------------------------------- | ---------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------- | ------------------------------- |
| 1   | **Открытия и клики по письмам**         | **Analytics (GA4)** | [Например: Event Tracking / UTM Parameters] | [Например: subscriber_id, email, campaign_id]      | [Например: event_name (email_open, email_click), email_campaign, link_url, utm_source, utm_medium]   | [Например: Отслеживание эффективности email-кампаний для расчета ROMI и оптимизации]       | [Например: UTM-параметры в ссылках писем, события GA4 через Measurement Protocol, синхронизация через API] | [Настроено / Требует настройки] |
| 2   | **Подписки и отписки**                  | **CRM**             | [Например: Webhook / API]                   | [Например: subscriber_id, email, lead_id]          | [Например: email, статус подписки (подписан / отписан), сегмент, источник подписки]                  | [Например: Синхронизация статуса подписки в CRM для управления сегментами и автоматизации] | [Например: Webhook endpoint в CRM, метод: POST, формат: JSON, триггер: при подписке/отписке]               | [Настроено / Требует настройки] |
| 3   | **Конверсии из email (клики, покупки)** | **CRM**             | [Например: Webhook / API]                   | [Например: subscriber_id, email, lead_id, deal_id] | [Например: тип события (click, purchase), значение конверсии, источник (email_campaign), utm_source] | [Например: Передача конверсий из email в CRM для расчета ROMI и атрибуции email-канала]    | [Например: Webhook endpoint в CRM, метод: POST, формат: JSON, триггер: при конверсии из email]             | [Настроено / Требует настройки] |

**Важно для ИИ-генерации:**

- Все интеграции должны поддерживать отслеживание эффективности email-кампаний для расчета ROMI
- Идентификаторы должны обеспечивать синхронизацию данных между ESP и CRM/Analytics
- UTM-параметры должны быть согласованы с Marketing_Strategy.md → UTM-структура

---

#### 5. Интеграции аналитики (GA4, Meta Pixel, Яндекс Метрика) с внешними системами

**[ОБЯЗАТЕЛЬНО]** Описать все интеграции, которые выполняет аналитика для передачи данных во внешние системы.

**Инструкция:** Для каждой интеграции указать источник данных в аналитике, получателя, метод интеграции, идентификаторы, цель и технические детали.

| №   | Источник данных в аналитике             | Получатель | Метод интеграции                       | Идентификаторы                                              | Поля данных                                                                                    | Цель передачи                                                                                     | Технические детали                                                                                                                   | Статус                          |
| --- | --------------------------------------- | ---------- | -------------------------------------- | ----------------------------------------------------------- | ---------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------- |
| 1   | **События конверсий (GA4, Meta Pixel)** | **CRM**    | [Например: Conversion API / Webhook]   | [Например: client_id, event_id, lead_id]                    | [Например: event_name (purchase, lead), value, currency, utm_source, utm_medium, utm_campaign] | [Например: Передача конверсий из аналитики в CRM для синхронизации данных и расчета ROMI]         | [Например: Webhook endpoint в CRM, метод: POST, формат: JSON, синхронизация через GA4 Measurement Protocol или Meta Conversions API] | [Настроено / Требует настройки] |
| 2   | **Данные о пользователях и сессиях**    | **CRM**    | [Например: API / User Properties Sync] | [Например: client_id, user_id, session_id]                  | [Например: страницы просмотра, время на сайте, источник трафика, сегмент аудитории]            | [Например: Обогащение данных лидов в CRM поведенческими данными для персонализации и сегментации] | [Например: API endpoint в CRM, метод: POST, формат: JSON, синхронизация через GA4 Data API]                                          | [Настроено / Требует настройки] |
| 3   | **Атрибуция и источники трафика**       | **CRM**    | [Например: API / UTM Sync]             | [Например: client_id, utm_source, utm_medium, utm_campaign] | [Например: utm_source, utm_medium, utm_campaign, utm_content, источник трафика, канал]         | [Например: Синхронизация атрибуции в CRM для расчета ROMI по каналам и оптимизации бюджета]       | [Например: API endpoint в CRM, метод: POST, формат: JSON, синхронизация UTM-параметров из GA4]                                       | [Настроено / Требует настройки] |

**Важно для ИИ-генерации:**

- Все интеграции должны поддерживать сквозную аналитику ROMI, CAC, LTV
- Идентификаторы должны обеспечивать привязку событий аналитики к лидам/сделкам в CRM
- UTM-параметры должны быть согласованы с Marketing_Strategy.md → UTM-структура

---

#### 6. Идентификаторы пользователей и синхронизация данных

**[ОБЯЗАТЕЛЬНО]** Описать все идентификаторы, используемые для синхронизации данных между системами.

**Инструкция:** Указать все идентификаторы пользователей и правила их синхронизации между системами.

**Основные идентификаторы:**

- **client_id** (GA4 / Analytics) — уникальный идентификатор пользователя в аналитике
- **user_id** (CRM) — уникальный идентификатор пользователя в CRM
- **lead_id** (CRM) — уникальный идентификатор лида в CRM
- **subscriber_id** (ESP) — уникальный идентификатор подписчика в ESP
- **email** — универсальный идентификатор для синхронизации между системами
- **phone** — дополнительный идентификатор для синхронизации (если применимо)

**Правила синхронизации идентификаторов:**

| Система-источник    | Идентификатор-источник | Система-получатель  | Идентификатор-получатель | Метод синхронизации                                                       | Приоритет |
| ------------------- | ---------------------- | ------------------- | ------------------------ | ------------------------------------------------------------------------- | --------- |
| **Сайт (CMS)**      | client_id (GA4)        | **CRM**             | user_id / lead_id        | Создание лида через форму → привязка client_id к lead_id через UTM/cookie | Высокий   |
| **CRM**             | lead_id / email        | **ESP**             | subscriber_id            | Синхронизация сегментов → привязка по email                               | Высокий   |
| **CRM**             | lead_id / client_id    | **Analytics (GA4)** | client_id / user_id      | Conversion API → привязка по client_id                                    | Высокий   |
| **ESP**             | subscriber_id / email  | **CRM**             | lead_id                  | Webhook подписки → привязка по email                                      | Средний   |
| **Analytics (GA4)** | client_id              | **CRM**             | user_id / lead_id        | События конверсий → привязка по client_id через Measurement Protocol      | Высокий   |

**Важно для ИИ-генерации:**

- Все идентификаторы должны быть согласованы между системами для обеспечения синхронизации данных
- Email должен быть основным идентификатором для синхронизации между CRM и ESP
- client_id должен быть основным идентификатором для синхронизации между Analytics и CRM

---

#### 7. Схема потоков данных (визуальное описание)

**[ОБЯЗАТЕЛЬНО]** Описать визуальную схему всех потоков данных между системами.

**Инструкция:** Создать текстовое описание схемы потоков данных, которое можно использовать для создания визуальной диаграммы или для понимания логики интеграций ИИ-агентами.

**Основные потоки данных:**

**Поток 1: Создание лида (Сайт → CRM → ESP → Analytics)**

1. Пользователь заполняет форму на сайте
2. Сайт отправляет данные в CRM через Webhook/API (создается lead_id)
3. CRM синхронизирует лида в ESP через API (создается subscriber_id, добавляется в сегмент)
4. Сайт отправляет событие в Analytics (GA4, Meta Pixel) через dataLayer/Pixel (создается client_id)
5. CRM отправляет конверсию в Analytics через Conversion API (привязка lead_id к client_id)
6. ESP отправляет события открытий/кликов в Analytics через UTM-параметры (привязка subscriber_id к client_id)

**Поток 2: Конверсия из email (ESP → CRM → Analytics)**

1. Пользователь кликает по ссылке в email (с UTM-параметрами)
2. ESP отправляет событие клика в CRM через Webhook (обновление статуса лида)
3. Сайт регистрирует событие в Analytics через UTM-параметры (event: email_click)
4. При конверсии (покупка/заявка) CRM отправляет событие в Analytics через Conversion API (event: purchase, привязка к client_id)

**Поток 3: Синхронизация атрибуции (Analytics → CRM)**

1. Analytics собирает данные о пользователях и источниках трафика (UTM-параметры, client_id)
2. Analytics отправляет данные атрибуции в CRM через API (привязка client_id к lead_id)
3. CRM обновляет данные лида (источник, канал, кампания) для расчета ROMI по каналам

**Поток 4: Автоматизация email-цепочек (CRM → ESP → Analytics)**

1. CRM создает/обновляет лида (статус, сегмент)
2. CRM синхронизирует сегмент в ESP через API (добавление/удаление из сегмента)
3. ESP активирует автоматическую email-цепочку для сегмента (Welcome Flow, Nurturing Flow)
4. ESP отправляет события открытий/кликов в Analytics через UTM-параметры (отслеживание эффективности)

**Важно для ИИ-генерации:**

- Все потоки данных должны быть описаны детально с указанием систем, методов интеграции и идентификаторов
- Потоки должны поддерживать сквозную аналитику ROMI, CAC, LTV
- Описание должно быть понятным для ИИ-агентов, которые будут настраивать интеграции

---

#### 8. Технические требования к интеграциям

**[ОБЯЗАТЕЛЬНО]** Описать технические требования для всех интеграций.

**Инструкция:** Указать общие технические требования для обеспечения надежности и производительности интеграций.

**Общие технические требования:**

- **Формат данных:** JSON (стандартный формат для всех API)
- **Метод аутентификации:** OAuth 2.0 / Bearer Token / API Key (в зависимости от системы)
- **Таймаут запросов:** ≤ 5 секунд (для обеспечения производительности)
- **Повторные попытки:** 3 попытки с экспоненциальной задержкой (1 сек, 2 сек, 4 сек)
- **Обработка ошибок:** Логирование всех ошибок интеграций для мониторинга и отладки
- **Безопасность:** HTTPS для всех API-запросов, валидация данных на стороне получателя

**Требования к производительности:**

- **Пропускная способность:** ≥ 1000 запросов/минуту (для обеспечения масштабируемости)
- **Задержка передачи данных:** ≤ 2 секунды (для обеспечения реального времени)
- **Надежность:** ≥ 99.9% успешных запросов (для обеспечения корректности данных)

**Требования к мониторингу:**

- Логирование всех интеграций (успешные и неуспешные запросы)
- Алерты при ошибках интеграций (≥ 5% ошибок за 5 минут)
- Дашборд для мониторинга статуса всех интеграций

**Важно для ИИ-генерации:**

- Все технические требования должны быть измеримыми и проверяемыми
- Требования должны обеспечивать надежность и производительность интеграций
- Мониторинг должен обеспечивать прозрачность работы всех интеграций

---

#### 9. План тестирования интеграций

**[ОБЯЗАТЕЛЬНО]** Описать план тестирования всех интеграций перед запуском проекта.

**Инструкция:** Указать этапы тестирования, критерии успешности и ответственных за тестирование.

**Этапы тестирования:**

| №   | Этап тестирования                                | Системы                            | Критерии успешности                                                                             | Ответственный                   | Срок               |
| --- | ------------------------------------------------ | ---------------------------------- | ----------------------------------------------------------------------------------------------- | ------------------------------- | ------------------ |
| 1   | **Тестирование интеграции сайта с CRM**          | Сайт → CRM                         | Форма заявки создает лида в CRM, все поля передаются корректно, идентификаторы синхронизируются | Full-Stack Developer            | [Например: 1 день] |
| 2   | **Тестирование интеграции сайта с ESP**          | Сайт → ESP                         | Форма подписки добавляет подписчика в ESP, сегмент создается корректно                          | Full-Stack Developer            | [Например: 1 день] |
| 3   | **Тестирование интеграции сайта с Analytics**    | Сайт → Analytics (GA4, Meta Pixel) | События регистрируются в Analytics, client_id создается, UTM-параметры передаются               | Data Analyst                    | [Например: 1 день] |
| 4   | **Тестирование интеграции CRM с ESP**            | CRM → ESP                          | Синхронизация сегментов работает, лиды добавляются/удаляются из сегментов корректно             | Marketing Automation Specialist | [Например: 1 день] |
| 5   | **Тестирование интеграции CRM с Analytics**      | CRM → Analytics                    | Conversion API работает, конверсии передаются в Analytics, привязка по client_id работает       | Data Analyst                    | [Например: 1 день] |
| 6   | **Тестирование интеграции ESP с Analytics**      | ESP → Analytics                    | UTM-параметры в ссылках работают, события email_open/email_click регистрируются                 | Email Marketing Specialist      | [Например: 1 день] |
| 7   | **Комплексное тестирование всех потоков данных** | Все системы                        | Все потоки данных работают корректно, идентификаторы синхронизируются, данные не теряются       | CTO                             | [Например: 2 дня]  |

**Важно для ИИ-генерации:**

- Все этапы тестирования должны быть детально описаны с критериями успешности
- Тестирование должно обеспечивать корректность всех интеграций перед запуском проекта
- План тестирования должен быть согласован с Project_Plan.md → сроки

---

#### 10. Схема идентификаторов и привязок

**[ОБЯЗАТЕЛЬНО]** Описать детальную схему всех идентификаторов и правил их привязки между системами.

**Инструкция:** Создать детальную таблицу всех идентификаторов и правил их синхронизации для обеспечения корректной работы всех интеграций.

| Идентификатор     | Система-источник | Уникальность                        | Формат                                                 | Правила синхронизации                                                     | Привязка к другим системам                                                                        |
| ----------------- | ---------------- | ----------------------------------- | ------------------------------------------------------ | ------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------- |
| **client_id**     | Analytics (GA4)  | Уникальный для каждого пользователя | [Например: "1234567890.1234567890" (число.число)]      | Создается при первом визите, хранится в cookie (\_ga), срок жизни: 2 года | Привязка к lead_id в CRM через Conversion API, привязка к subscriber_id в ESP через UTM-параметры |
| **lead_id**       | CRM              | Уникальный для каждого лида         | [Например: "12345" (число) или "lead_abc123" (строка)] | Создается при создании лида, постоянный                                   | Привязка к client_id через Conversion API, привязка к subscriber_id через email                   |
| **subscriber_id** | ESP              | Уникальный для каждого подписчика   | [Например: "sub_abc123" (строка) или "12345" (число)]  | Создается при подписке, постоянный                                        | Привязка к lead_id через email, привязка к client_id через UTM-параметры                          |
| **email**         | Универсальный    | Уникальный для каждого пользователя | [Например: "user@example.com" (email формат)]          | Используется для синхронизации между CRM и ESP                            | Основной идентификатор для синхронизации между CRM и ESP                                          |
| **user_id**       | CRM              | Уникальный для каждого пользователя | [Например: "user_12345" (строка) или "12345" (число)]  | Создается при регистрации/создании лида, постоянный                       | Привязка к client_id через Conversion API, привязка к subscriber_id через email                   |

**Правила привязки идентификаторов:**

1. **Привязка client_id к lead_id:**

   - При создании лида через форму на сайте: client_id передается в CRM через поле "client_id" или UTM-параметр
   - При конверсии: CRM отправляет событие в Analytics через Conversion API с привязкой client_id к lead_id

2. **Привязка lead_id к subscriber_id:**

   - При синхронизации сегмента: CRM отправляет список лидов (email + lead_id) в ESP через API
   - ESP создает/обновляет подписчиков и возвращает subscriber_id для каждого email

3. **Привязка subscriber_id к client_id:**
   - При клике по ссылке в email: UTM-параметры содержат subscriber_id, который передается в Analytics
   - Analytics привязывает subscriber_id к client_id через UTM-параметры

**Важно для ИИ-генерации:**

- Все идентификаторы должны быть детально описаны с форматами и правилами синхронизации
- Правила привязки должны обеспечивать корректную синхронизацию данных между всеми системами
- Схема должна быть понятной для ИИ-агентов, которые будут настраивать интеграции

---

**Передача следующему этапу:**
Этот документ передаётся на следующий этап **05_2_Website_Development_and_Deployment** (Full-Stack Developer) для использования при настройке интеграций сайта с внешними системами. Также используется на этапах **05_3_App_Development_and_Integration**, **05_5_Analytics_Implementation_and_Data_Layer_Setup**, **05_7_CRM_and_Data_Sync_Integration** для настройки всех интеграций между системами.
